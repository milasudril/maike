<?xml version="1.0"?>
<document title="Maike 2.0 user guide">
	<copyright>
		<author name="TorbjÃ¶rn Rathsman">
			<year value="2021" />
		</author>
	</copyright>
	<resources>
		<link rel="stylesheet" href="./format.css" />
	</resources>
	<prelims>
		<tableofcontents/>
	</prelims>
	<main>
		<chapter title="Introduction" id="Introduction">
			<p>Maike is a build system based on scanning of source files. To construct the dependency graph, Maike uses embedded JSON data to control the compilation process. This allows for a minimal amount makefile maintanence, since when a new file is added to the project, dependencies form that file will be maintained by the file itself. This is also true for interfaces with a separate implementation file. The interface file may point to the implementation file, which will be used when linking an application that uses the particular interfafce.</p>

			<p>Maike guarantees that your project does not have any file-level cyclic dependencies. In case a cyclic dependency is detected, the build job will fail. Also, a broken dependency graph will result in a build error.</p>

			<section title="Limitations" id="limitations"><p>It is not possible to have target files that defines new targets. This limitation comes from the fact that Maike separates the scanning phase from the compilation phase, see <ref item="algo" />. However, this choice also guarantees that everything is correctly setup before the compilation process starts.</p>
			</section>
			<section title="Changes compared to version 1.0" id="changes_v1_v2"/>
			<section title="Maike compared to other build systems" id="comparison"/>
		</chapter>
		<chapter title="Installation procedure" id="Installation">
		</chapter>
		<chapter title="Tagging source files" id="tagging">
		</chapter>
		<chapter title="Using extensions" id="extensions">
		</chapter>
	</main>
	<appendix>
		<chapter title="Command line options" id="cmdlineopts">
			<include src="./cmdlineopts.xml" />
		</chapter>
		<chapter title="Default configuration" id="defaultcfg">
			<include src="./configdefault.xml" />
		</chapter>
		<chapter title="Recipe commands" id="commands">
		</chapter>
		<chapter title="Compilation log format">
		</chapter>
		<chapter title="Schematics" id="schematics">
			<section title="Components" id="components">
				<img src="./components.svg" />
			</section>

			<section title="Processing algorithms" id="algo">
				<img src="./pipeline.svg" />

				<subsection title="Initialize" id="init">
					<img src="./initialize.svg" />
					<subsubsection title="Resolve recipes" id="resolve_recipes">
						<img src="./resolve_recipes.svg" />
					</subsubsection>
				</subsection>

				<subsection title="Load source tree" id="load_src_tree">
					<img src="./load_source_tree.svg" />

					<subsubsection title="Source tree loader" id="src_tree_loader">
						<img src="./source_tree_loader.svg" />

						<paragraph title="Use entry" id="use_entry">
							<p>This is some text, lol</p>
							<p><img src="./use_entry.svg" /></p>
						</paragraph>
					</subsubsection>

					<subsubsection title="Make dependency graph" id="load_dep_graph">
						<img src="./make_dep_graph.svg" />
					</subsubsection>
				</subsection>

				<subsection title="Compile project" id="compile">
					<img src="./compile.svg" />

					<subsubsection title="Create task list" id="create_task_list">
						<img src="./create_task_list.svg" />
						<paragraph title="Create task"  id="create_task">
							<p><img src="./create_task.svg"/></p>
						</paragraph>
					</subsubsection>

					<subsection title="Process task list" id="process_task_list">
						<img src="./process_task_list.svg" />
					</subsection>
				</subsection>
			</section>
		</chapter>
	</appendix>
</document>
